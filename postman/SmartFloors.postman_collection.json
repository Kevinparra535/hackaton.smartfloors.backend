{
  "info": {
    "name": "SmartFloors Backend API",
    "_postman_id": "smartfloors-api-2025",
    "description": "Colección completa de endpoints para el backend de SmartFloors\n\n## Características\n- Monitoreo en tiempo real de pisos\n- Predicciones con ML (Moving Average + Linear Regression)\n- Detección de anomalías y alertas inteligentes\n- Alertas preventivas basadas en predicciones futuras\n- Exportación de alertas e historial a CSV\n\n## Funcionalidades\n### Monitoreo\n- Datos actuales de temperatura, humedad, ocupación y energía\n- Estadísticas generales del edificio\n- Historial de hasta 24 horas (1440 registros)\n\n### Predicciones\n- Predicciones de 10 a 180 minutos en el futuro\n- 6 puntos de predicción cada 10 minutos\n- Algoritmo híbrido: 60% MA + 40% LR\n\n### Alertas\n- Detección de anomalías en tiempo real\n- 10 tipos de alertas (6 actuales + 4 predictivas)\n- Sobrecarga térmica (temperatura + energía)\n- Alertas preventivas antes de que ocurran problemas\n\n### Exportación CSV\n- Exportar alertas con múltiples filtros\n- Exportar historial de datos del simulador\n- Filtros: fecha, severidad, piso, tipo, predictivas\n- Compatible con Excel (UTF-8 BOM)\n\n## Variables\n- `base_url`: http://localhost:3000\n- `api_version`: v1\n\n## Endpoints Totales: 23\n- Health Check: 1\n- Pisos: 5\n- Alertas: 6\n- Exportación CSV: 10\n- Validaciones: 13\n\n## Autor\nSmartFloors Team - Hackathon 2025",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "api_version",
      "value": "v1",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "item": [
        {
          "name": "Check Server Status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has status OK\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.status).to.eql(\"OK\");",
                  "});",
                  "",
                  "pm.test(\"Response has timestamp\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('timestamp');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Verifica que el servidor esté funcionando correctamente"
          },
          "response": []
        }
      ],
      "description": "Endpoints para verificar el estado del servidor"
    },
    {
      "name": "Pisos",
      "item": [
        {
          "name": "Get All Floors",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "});",
                  "",
                  "pm.test(\"Response has data array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Each floor has required properties\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    jsonData.data.forEach(function(floor) {",
                  "        pm.expect(floor).to.have.property('floorId');",
                  "        pm.expect(floor).to.have.property('name');",
                  "        pm.expect(floor).to.have.property('occupancy');",
                  "        pm.expect(floor).to.have.property('temperature');",
                  "        pm.expect(floor).to.have.property('humidity');",
                  "        pm.expect(floor).to.have.property('powerConsumption');",
                  "        pm.expect(floor).to.have.property('timestamp');",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors"]
            },
            "description": "Obtiene los datos actuales de todos los pisos del edificio"
          },
          "response": []
        },
        {
          "name": "Get Floor By ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is successful\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.be.true;",
                  "});",
                  "",
                  "pm.test(\"Floor data has correct structure\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('floorId');",
                  "    pm.expect(jsonData.data.floorId).to.eql(1);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1"]
            },
            "description": "Obtiene los datos actuales de un piso específico por su ID"
          },
          "response": []
        },
        {
          "name": "Get Floor Statistics",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has statistics\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('totalFloors');",
                  "    pm.expect(jsonData.data).to.have.property('totalOccupancy');",
                  "    pm.expect(jsonData.data).to.have.property('averageTemperature');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "stats"]
            },
            "description": "Obtiene estadísticas generales de todos los pisos"
          },
          "response": []
        },
        {
          "name": "Get Floor History",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has history data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('history');",
                  "    pm.expect(jsonData.data.history).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1/history?limit=60",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1", "history"],
              "query": [
                {
                  "key": "limit",
                  "value": "60",
                  "description": "Número de registros a obtener (1-1440)"
                }
              ]
            },
            "description": "Obtiene el historial de datos de un piso específico"
          },
          "response": []
        },
        {
          "name": "Get Floor Predictions",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has predictions\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('predictions');",
                  "    pm.expect(jsonData.data.predictions).to.have.property('occupancy');",
                  "    pm.expect(jsonData.data.predictions).to.have.property('temperature');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1/predictions?minutesAhead=60",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1", "predictions"],
              "query": [
                {
                  "key": "minutesAhead",
                  "value": "60",
                  "description": "Minutos a predecir en el futuro (10-180)"
                }
              ]
            },
            "description": "Obtiene predicciones futuras para un piso específico usando ML"
          },
          "response": []
        }
      ],
      "description": "Endpoints relacionados con los datos de los pisos"
    },
    {
      "name": "Alertas",
      "item": [
        {
          "name": "Get All Alerts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has alerts\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('alerts');",
                  "    pm.expect(jsonData.data.alerts).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Response has count\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('count');",
                  "});",
                  "",
                  "pm.test(\"Each alert has required properties\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    if (jsonData.data.alerts.length > 0) {",
                  "        jsonData.data.alerts.forEach(function(alert) {",
                  "            pm.expect(alert).to.have.property('floorId');",
                  "            pm.expect(alert).to.have.property('severity');",
                  "            pm.expect(alert).to.have.property('anomalies');",
                  "            pm.expect(alert.anomalies).to.be.an('array');",
                  "        });",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"]
            },
            "description": "Obtiene todas las alertas activas del sistema de detección de anomalías"
          },
          "response": []
        },
        {
          "name": "Get Critical Alerts Only",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"All alerts are critical\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    jsonData.data.alerts.forEach(function(alert) {",
                  "        pm.expect(alert.severity).to.eql('critical');",
                  "    });",
                  "});",
                  "",
                  "pm.test(\"Response has filters applied\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.filters.severity).to.eql('critical');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?severity=critical",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "severity",
                  "value": "critical",
                  "description": "Filtrar por severidad (critical, warning, info)"
                }
              ]
            },
            "description": "Obtiene solo las alertas críticas del sistema"
          },
          "response": []
        },
        {
          "name": "Get Alerts by Floor",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"All alerts are from floor 3\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    jsonData.data.alerts.forEach(function(alert) {",
                  "        pm.expect(alert.floorId).to.eql(3);",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?floorId=3",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "floorId",
                  "value": "3",
                  "description": "Filtrar por ID de piso (1-100)"
                }
              ]
            },
            "description": "Obtiene alertas de un piso específico"
          },
          "response": []
        },
        {
          "name": "Get Alerts by Type",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"All alerts contain temperature anomaly\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    jsonData.data.alerts.forEach(function(alert) {",
                  "        var hasTemperature = alert.anomalies.some(function(anomaly) {",
                  "            return anomaly.type === 'temperature';",
                  "        });",
                  "        pm.expect(hasTemperature).to.be.true;",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?type=temperature",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "type",
                  "value": "temperature",
                  "description": "Filtrar por tipo de anomalía (occupancy, temperature, humidity, power, thermal_overload, sudden_change)"
                }
              ]
            },
            "description": "Obtiene alertas que contengan un tipo específico de anomalía"
          },
          "response": []
        },
        {
          "name": "Get Alerts with Multiple Filters",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response respects limit\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.alerts.length).to.be.at.most(5);",
                  "});",
                  "",
                  "pm.test(\"Filters are applied correctly\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data.filters).to.have.property('severity');",
                  "    pm.expect(jsonData.data.filters).to.have.property('floorId');",
                  "    pm.expect(jsonData.data.filters).to.have.property('limit');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?severity=critical&floorId=3&limit=5",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "severity",
                  "value": "critical",
                  "description": "Severidad de alerta"
                },
                {
                  "key": "floorId",
                  "value": "3",
                  "description": "ID del piso"
                },
                {
                  "key": "limit",
                  "value": "5",
                  "description": "Máximo de resultados (1-100)"
                }
              ]
            },
            "description": "Obtiene alertas combinando múltiples filtros: severidad crítica, del piso 3, limitado a 5 resultados"
          },
          "response": []
        },
        {
          "name": "Get Thermal Overload Alerts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"All alerts contain thermal_overload anomaly\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    jsonData.data.alerts.forEach(function(alert) {",
                  "        var hasThermalOverload = alert.anomalies.some(function(anomaly) {",
                  "            return anomaly.type === 'thermal_overload';",
                  "        });",
                  "        pm.expect(hasThermalOverload).to.be.true;",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?type=thermal_overload",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "type",
                  "value": "thermal_overload",
                  "description": "Filtrar alertas de sobrecarga térmica"
                }
              ]
            },
            "description": "Obtiene alertas de riesgo de sobrecarga térmica (temperatura alta + consumo energético alto)"
          },
          "response": []
        }
      ],
      "description": "Endpoints para gestión de alertas y anomalías con capacidades de filtrado"
    },
    {
      "name": "Exportación CSV",
      "item": [
        {
          "name": "Get Export Statistics",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has alerts statistics\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('alerts');",
                  "    pm.expect(jsonData.data.alerts).to.have.property('total');",
                  "    pm.expect(jsonData.data.alerts).to.have.property('byType');",
                  "    pm.expect(jsonData.data.alerts).to.have.property('bySeverity');",
                  "});",
                  "",
                  "pm.test(\"Response has history statistics\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.data).to.have.property('history');",
                  "    pm.expect(jsonData.data.history).to.have.property('total');",
                  "    pm.expect(jsonData.data.history).to.have.property('byFloor');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/stats",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "stats"]
            },
            "description": "Obtiene estadísticas de datos disponibles para exportar (alertas e historial)"
          },
          "response": []
        },
        {
          "name": "Export All Alerts to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is CSV format\", function () {",
                  "    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/csv');",
                  "});",
                  "",
                  "pm.test(\"CSV has headers\", function () {",
                  "    var csvData = pm.response.text();",
                  "    pm.expect(csvData).to.include('timestamp');",
                  "    pm.expect(csvData).to.include('floorId');",
                  "    pm.expect(csvData).to.include('severity');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"]
            },
            "description": "Exporta todas las alertas activas a formato CSV. El archivo se descarga automáticamente."
          },
          "response": []
        },
        {
          "name": "Export Critical Alerts to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test(\"Response is CSV format\", function () {",
                  "        pm.expect(pm.response.headers.get('Content-Type')).to.include('text/csv');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?severity=critical",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "severity",
                  "value": "critical",
                  "description": "Filtrar solo alertas críticas"
                }
              ]
            },
            "description": "Exporta solo las alertas de severidad crítica a CSV"
          },
          "response": []
        },
        {
          "name": "Export Alerts by Floor to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?floorId=1",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "floorId",
                  "value": "1",
                  "description": "Filtrar alertas del piso 1"
                }
              ]
            },
            "description": "Exporta alertas de un piso específico a CSV"
          },
          "response": []
        },
        {
          "name": "Export Predictive Alerts to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test(\"CSV contains predictive alerts\", function () {",
                  "        var csvData = pm.response.text();",
                  "        pm.expect(csvData).to.include('Si');",
                  "        pm.expect(csvData).to.include('minutesAhead');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?isPredictive=true",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "isPredictive",
                  "value": "true",
                  "description": "Filtrar solo alertas preventivas/predictivas"
                }
              ]
            },
            "description": "Exporta solo las alertas preventivas (basadas en predicciones) a CSV"
          },
          "response": []
        },
        {
          "name": "Export Thermal Overload Alerts to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?type=thermal_overload",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "type",
                  "value": "thermal_overload",
                  "description": "Filtrar alertas de sobrecarga térmica"
                }
              ]
            },
            "description": "Exporta alertas de sobrecarga térmica a CSV"
          },
          "response": []
        },
        {
          "name": "Export Alerts with Date Range",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?startDate=2025-11-12T00:00:00Z&endDate=2025-11-12T23:59:59Z",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2025-11-12T00:00:00Z",
                  "description": "Fecha de inicio (ISO 8601)"
                },
                {
                  "key": "endDate",
                  "value": "2025-11-12T23:59:59Z",
                  "description": "Fecha de fin (ISO 8601)"
                }
              ]
            },
            "description": "Exporta alertas dentro de un rango de fechas específico"
          },
          "response": []
        },
        {
          "name": "Export All History to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is CSV format\", function () {",
                  "    pm.expect(pm.response.headers.get('Content-Type')).to.include('text/csv');",
                  "});",
                  "",
                  "pm.test(\"CSV has history headers\", function () {",
                  "    var csvData = pm.response.text();",
                  "    pm.expect(csvData).to.include('temperature');",
                  "    pm.expect(csvData).to.include('humidity');",
                  "    pm.expect(csvData).to.include('occupancy');",
                  "    pm.expect(csvData).to.include('powerConsumption');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/history/csv",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "history", "csv"]
            },
            "description": "Exporta todo el historial de datos del simulador a CSV (temperatura, humedad, ocupación, energía)"
          },
          "response": []
        },
        {
          "name": "Export Floor History to CSV",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"CSV contains only floor 1 data\", function () {",
                  "    var csvData = pm.response.text();",
                  "    var lines = csvData.split('\\n');",
                  "    // Skip header line",
                  "    for (var i = 1; i < lines.length && i < 10; i++) {",
                  "        if (lines[i].trim()) {",
                  "            var columns = lines[i].split(',');",
                  "            if (columns.length > 1) {",
                  "                pm.expect(columns[1]).to.include('1');",
                  "            }",
                  "        }",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/history/csv?floorId=1&limit=100",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "history", "csv"],
              "query": [
                {
                  "key": "floorId",
                  "value": "1",
                  "description": "Piso específico"
                },
                {
                  "key": "limit",
                  "value": "100",
                  "description": "Límite de registros (1-10000)"
                }
              ]
            },
            "description": "Exporta el historial de un piso específico con límite de registros"
          },
          "response": []
        },
        {
          "name": "Export History with Date Filter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 404\", function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/history/csv?startDate=2025-11-12T00:00:00Z",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "history", "csv"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2025-11-12T00:00:00Z",
                  "description": "Fecha de inicio para filtrar historial"
                }
              ]
            },
            "description": "Exporta historial filtrado por fecha de inicio"
          },
          "response": []
        }
      ],
      "description": "Endpoints para exportar alertas e historial a formato CSV con múltiples opciones de filtrado"
    },
    {
      "name": "Validaciones (Errores esperados)",
      "item": [
        {
          "name": "Invalid Floor ID - Not a Number",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message is correct\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"número\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/abc",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "abc"]
            },
            "description": "Prueba validación: ID debe ser numérico"
          },
          "response": []
        },
        {
          "name": "Invalid Floor ID - Out of Range (0)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions minimum\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"mayor\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/0",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "0"]
            },
            "description": "Prueba validación: ID debe ser >= 1"
          },
          "response": []
        },
        {
          "name": "Invalid Floor ID - Out of Range (101)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions maximum\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"menor\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/101",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "101"]
            },
            "description": "Prueba validación: ID debe ser <= 100"
          },
          "response": []
        },
        {
          "name": "Invalid History Limit - Too High",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions limit\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"1440\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1/history?limit=2000",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1", "history"],
              "query": [
                {
                  "key": "limit",
                  "value": "2000"
                }
              ]
            },
            "description": "Prueba validación: limit debe ser <= 1440"
          },
          "response": []
        },
        {
          "name": "Invalid Predictions - Minutes Too Low",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions minimum minutes\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"10\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1/predictions?minutesAhead=5",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1", "predictions"],
              "query": [
                {
                  "key": "minutesAhead",
                  "value": "5"
                }
              ]
            },
            "description": "Prueba validación: minutesAhead debe ser >= 10"
          },
          "response": []
        },
        {
          "name": "Invalid Predictions - Minutes Too High",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions maximum minutes\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"180\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/floors/1/predictions?minutesAhead=200",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "floors", "1", "predictions"],
              "query": [
                {
                  "key": "minutesAhead",
                  "value": "200"
                }
              ]
            },
            "description": "Prueba validación: minutesAhead debe ser <= 180"
          },
          "response": []
        },
        {
          "name": "Invalid Alert Severity",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions valid severities\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"critical\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?severity=invalid",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "severity",
                  "value": "invalid"
                }
              ]
            },
            "description": "Prueba validación: severity debe ser critical, warning o info"
          },
          "response": []
        },
        {
          "name": "Invalid Alert Type",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions valid types\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"occupancy\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?type=invalid_type",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "type",
                  "value": "invalid_type"
                }
              ]
            },
            "description": "Prueba validación: type debe ser uno de los tipos válidos de anomalía"
          },
          "response": []
        },
        {
          "name": "Invalid Alert Limit - Too High",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions maximum limit\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"100\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?limit=150",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "limit",
                  "value": "150"
                }
              ]
            },
            "description": "Prueba validación: limit de alertas debe ser <= 100"
          },
          "response": []
        },
        {
          "name": "Invalid Alert FloorId in Filter",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions floor ID range\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"piso\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/alerts?floorId=999",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "alerts"],
              "query": [
                {
                  "key": "floorId",
                  "value": "999"
                }
              ]
            },
            "description": "Prueba validación: floorId en filtro debe ser 1-100"
          },
          "response": []
        },
        {
          "name": "Invalid Export Date Format",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions date format\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"fecha\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?startDate=invalid-date",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "startDate",
                  "value": "invalid-date"
                }
              ]
            },
            "description": "Prueba validación: startDate debe ser formato ISO 8601"
          },
          "response": []
        },
        {
          "name": "Invalid Export History Limit",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions limit\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"10000\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/history/csv?limit=20000",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "history", "csv"],
              "query": [
                {
                  "key": "limit",
                  "value": "20000"
                }
              ]
            },
            "description": "Prueba validación: limit de historial debe ser <= 10000"
          },
          "response": []
        },
        {
          "name": "Invalid Export EndDate Before StartDate",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error message mentions date range\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData.error.message).to.include(\"posterior\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/{{api_version}}/export/alerts/csv?startDate=2025-11-12T23:00:00Z&endDate=2025-11-12T00:00:00Z",
              "host": ["{{base_url}}"],
              "path": ["api", "{{api_version}}", "export", "alerts", "csv"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2025-11-12T23:00:00Z"
                },
                {
                  "key": "endDate",
                  "value": "2025-11-12T00:00:00Z"
                }
              ]
            },
            "description": "Prueba validación: endDate debe ser posterior a startDate"
          },
          "response": []
        }
      ],
      "description": "Pruebas de validación de schemas con Joi - Todos estos endpoints deben retornar error 400"
    }
  ]
}
